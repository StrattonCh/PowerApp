subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[6], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[6]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[6], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
unique(rel_freq_tbl$SpGroup)
View(rel_freq_tbl)
head(rel_freq_tbl)
summary(rel_freq_tbl$SampleYear)
unique(rel_freq_tbl$Sample_Frame)
sort(unique(rel_freq_tbl$Sample_Frame))
unique(rel_freq_tbl$SpGroup)
rep(unique(rel_freq_tbl$SpGroup), each = 6)
7*30*6
30*56
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 30)
)
rep(2012:2018, each = 30*56)
2012:2018
rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56)
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7)
)
View(complete_df)
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7),
SpGroup = rep(rep(rep(unique(rel_freq_tbl$SpGroup), each = 6), 30), 7)
)
unique(rel_freq_tbl$SpGroup)
30*56
length(2012:2018)
1680*7
length(rep(2012:2018, each = 30*56))
length(rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7))
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7),
SpGroup = rep(rep(rep(unique(rel_freq_tbl$SpGroup), each = 7), 30), 7)
)
left_join(complete_df, rel_feq_tbl)
left_join(complete_df, rel_freq_tbl)
left_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- left_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
View(complete_freq_tbl)
?left_join
complete_freq_tbl <- full_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
rm(list = ls())
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(dplyr)
library(knitr)
library(ggplot2)
library(readxl)
library(tidyr)
library(animation)
monitoring_data <- read_excel("monitoring_data.xlsx")
species_codes <- read_excel("species_codes.xlsx")
species_group <- function(species){
species_codes[which(species_codes$SpName == species), ]$SpGroup
}
#################
### TIDY DATA ###
#################
# teton_data <- monitoring_data %>%
#   arrange(SampleYear, Quadrat_ID) #sort by year and quad id
#
# teton_data_long <- monitoring_data %>%
#   arrange(SampleYear, Quadrat_ID) %>% #sort by year and quad id
#   gather(species, coverage, BareGround:"Viola spp", factor_key = TRUE) %>% #wide to long
#   mutate(SpGroup = sapply(species, species_group))
# teton_data_long$coverage <- as.factor(teton_data_long$coverage)
# save(teton_data_long, file = "teton_data_long.Rdata")
load("teton_data_long.Rdata")
##############
### COUNTS ###
##############
counts_coverage_spgroup <- teton_data_long %>%
group_by(SampleYear, Sample_Frame, SpGroup) %>%
summarize('0' = summary(coverage)[1],
'1' = summary(coverage)[2],
'2' = summary(coverage)[3],
'3' = summary(coverage)[4],
'4' = summary(coverage)[5],
'5' = summary(coverage)[6],
'6' = summary(coverage)[7]) %>%
gather(cov_class, count, '0':'6', factor_key = T) %>%
arrange(Sample_Frame, SampleYear, cov_class)
# ggplot(filter(counts_coverage_spgroup, Sample_Frame == 'GRTE_01')) +
#   geom_col(aes(SpGroup, count)) +
#   facet_wrap( ~ cov_class)
###################
## Expand Tibble ##
###################
# long_tbl <- teton_data_long %>%
#   group_by(SampleYear, Sample_Frame, SpGroup) %>%
#   summarize('0' = summary(coverage)[1],
#             '1' = summary(coverage)[2],
#             '2' = summary(coverage)[3],
#             '3' = summary(coverage)[4],
#             '4' = summary(coverage)[5],
#             '5' = summary(coverage)[6],
#             '6' = summary(coverage)[7]) %>%
#   gather(cov_class, count, '0':'6', factor_key = T) %>%
#   group_by(SampleYear, Sample_Frame, SpGroup, cov_class) %>%
#   expand(count = seq(1:count)) %>%
#   select(-count)
# save(long_tbl, file = "long_tbl.Rdata")
load("long_tbl.Rdata")
# ggplot(filter(long_tbl, Sample_Frame == 'GRTE_01', SampleYear == '2012')) +
#   geom_bar(aes(SpGroup)) +
#   facet_wrap( ~ cov_class) +
#   theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
#   labs(title = 'Counts of each species group by coverage class',
#        subtitle = 'GRTE_01, Year 2012',
#        x = 'Species Group',
#        y = 'Count')
############################
### RELATIVE FREQUENCIES ###
############################
totals_tbl <- long_tbl %>%
group_by(SampleYear, Sample_Frame, SpGroup) %>%
tally()
rel_freq_tbl <- left_join(counts_coverage_spgroup, totals_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup')) %>%
mutate(rel_freq = count / n) %>%
arrange(SampleYear, Sample_Frame, SpGroup)
# save(rel_freq_tbl, file = "rel_freq_tbl.Rdata")
rel_freq_tbl %>%
filter(Sample_Frame == "GRTE_01", SampleYear == 2012) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ SpGroup) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by species group',
subtitle = 'GRTE_01, Year 2012',
x = 'Coverage Class',
y = 'Relative Frequency',
caption = 'SpGroup - Other includes bareground, soil crust, litter, moss, and rock.')
rel_freq_tbl %>%
filter(Sample_Frame == "GRTE_01", SampleYear == 2014) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ SpGroup) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by species group',
subtitle = 'GRTE_01, Year 2014',
x = 'Coverage Class',
y = 'Relative Frequency',
caption = 'SpGroup - Other includes bareground, soil crust, litter, moss, and rock.')
rel_freq_tbl %>%
filter(Sample_Frame == "GRTE_01", SampleYear == 2017) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ SpGroup) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by species group',
subtitle = 'GRTE_01, Year 2017',
x = 'Coverage Class',
y = 'Relative Frequency',
caption = 'SpGroup - Other includes bareground, soil crust, litter, moss, and rock.')
##############
### COUNTS ###
##############
counts_coverage_spgroup <- teton_data_long %>%
group_by(SampleYear, Sample_Frame, SpGroup) %>%
summarize('0' = summary(coverage)[1],
'1' = summary(coverage)[2],
'2' = summary(coverage)[3],
'3' = summary(coverage)[4],
'4' = summary(coverage)[5],
'5' = summary(coverage)[6],
'6' = summary(coverage)[7]) %>%
gather(cov_class, count, '0':'6', factor_key = T) %>%
arrange(Sample_Frame, SampleYear, cov_class)
# ggplot(filter(counts_coverage_spgroup, Sample_Frame == 'GRTE_01')) +
#   geom_col(aes(SpGroup, count)) +
#   facet_wrap( ~ cov_class)
###################
## Expand Tibble ##
###################
# long_tbl <- teton_data_long %>%
#   group_by(SampleYear, Sample_Frame, SpGroup) %>%
#   summarize('0' = summary(coverage)[1],
#             '1' = summary(coverage)[2],
#             '2' = summary(coverage)[3],
#             '3' = summary(coverage)[4],
#             '4' = summary(coverage)[5],
#             '5' = summary(coverage)[6],
#             '6' = summary(coverage)[7]) %>%
#   gather(cov_class, count, '0':'6', factor_key = T) %>%
#   group_by(SampleYear, Sample_Frame, SpGroup, cov_class) %>%
#   expand(count = seq(1:count)) %>%
#   select(-count)
# save(long_tbl, file = "long_tbl.Rdata")
load("long_tbl.Rdata")
# ggplot(filter(long_tbl, Sample_Frame == 'GRTE_01', SampleYear == '2012')) +
#   geom_bar(aes(SpGroup)) +
#   facet_wrap( ~ cov_class) +
#   theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
#   labs(title = 'Counts of each species group by coverage class',
#        subtitle = 'GRTE_01, Year 2012',
#        x = 'Species Group',
#        y = 'Count')
############################
### RELATIVE FREQUENCIES ###
############################
totals_tbl <- long_tbl %>%
group_by(SampleYear, Sample_Frame, SpGroup) %>%
tally()
rel_freq_tbl <- left_join(counts_coverage_spgroup, totals_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup')) %>%
mutate(rel_freq = count / n) %>%
arrange(SampleYear, Sample_Frame, SpGroup)
# save(rel_freq_tbl, file = "rel_freq_tbl.Rdata")
rel_freq_tbl %>%
filter(Sample_Frame == "GRTE_01", SampleYear == 2012) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ SpGroup) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by species group',
subtitle = 'GRTE_01, Year 2012',
x = 'Coverage Class',
y = 'Relative Frequency',
caption = 'SpGroup - Other includes bareground, soil crust, litter, moss, and rock.')
rel_freq_tbl %>%
filter(Sample_Frame == "GRTE_01", SampleYear == 2014) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ SpGroup) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by species group',
subtitle = 'GRTE_01, Year 2014',
x = 'Coverage Class',
y = 'Relative Frequency',
caption = 'SpGroup - Other includes bareground, soil crust, litter, moss, and rock.')
rel_freq_tbl %>%
filter(Sample_Frame == "GRTE_01", SampleYear == 2017) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ SpGroup) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by species group',
subtitle = 'GRTE_01, Year 2017',
x = 'Coverage Class',
y = 'Relative Frequency',
caption = 'SpGroup - Other includes bareground, soil crust, litter, moss, and rock.')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == "Natv other forbs") %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = 'Species Group: Natv other forbs\nYear: 2012',
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[2]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[2], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[3]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[3], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[4]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[4], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[5]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[5], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[6]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[6], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[7]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[7], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
rel_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == unique(SpGroup)[8]) %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = paste('Species Group:',  unique(rel_freq_tbl$SpGroup)[8], '\nYear: 2012'),
x = 'Coverage Class',
y = 'Relative Frequency')
## make dataframe that includes 0's for frames not sampled each year
complete_d tibble(
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7),
SpGroup = rep(rep(rep(unique(rel_freq_tbl$SpGroup), each = 7), 30), 7)
)
complete_freq_tbl <- full_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
View(complete_df)
complete_freq_tbl <- inner_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
View(complete_freq_tbl)
complete_freq_tbl <- inner_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- left_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- right_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- full_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- semi_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- semi_join(rel_freq_tbl, complete_df, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
View(complete_freq_tbl)
complete_freq_tbl <- anti_join(rel_freq_tbl, complete_df, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- inner_join(rel_freq_tbl, complete_df, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
complete_freq_tbl <- inner_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup'))
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7),
SpGroup = rep(rep(rep(unique(rel_freq_tbl$SpGroup), each = 7), 30), 7),
cov_class = rep(rep(rep(0:6, each = 8), 30), 7)
)
complete_freq_tbl <- inner_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup', 'cov_class'))
summary(rel_freq_tbl)
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7),
SpGroup = rep(rep(rep(unique(rel_freq_tbl$SpGroup), each = 7), 30), 7),
cov_class = as.factor(rep(rep(rep(0:6, each = 8), 30), 7))
)
complete_freq_tbl <- inner_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup', 'cov_class'))
View(complete_freq_tbl)
complete_freq_tbl <- full_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup', 'cov_class'))
complete_freq_tbl <- left_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup', 'cov_class'))
View(complete_freq_tbl)
complete_freq_tbl <- left_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup', 'cov_class')) %>%
mutate_all(funs(replace(., is.na(.), 0)))
View(complete_freq_tbl)
## make dataframe that includes 0's for frames not sampled each year
complete_df <- tibble(
SampleYear = rep(2012:2018, each = 30*56),
Sample_Frame = rep(rep(sort(unique(rel_freq_tbl$Sample_Frame)), each = 56), 7),
SpGroup = rep(rep(rep(unique(rel_freq_tbl$SpGroup), each = 7), 30), 7),
cov_class = as.factor(rep(rep(rep(0:6, 8), 30), 7))
)
complete_freq_tbl <- left_join(complete_df, rel_freq_tbl, by = c('SampleYear', 'Sample_Frame', 'SpGroup', 'cov_class')) %>%
mutate_all(funs(replace(., is.na(.), 0)))
View(complete_freq_tbl)
complete_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == "Natv other forbs") %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = 'Species Group: Natv other forbs\nYear: 2012',
x = 'Coverage Class',
y = 'Relative Frequency')
?pnorm
````````````````````````````````````````complete_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == "Natv other forbs") %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = 'Species Group: Natv other forbs\nYear: 2012',
x = 'Coverage Class',
y = 'Relative Frequency')
complete_freq_tbl %>%
filter(SampleYear == "2012", SpGroup == "Natv other forbs") %>%
ungroup() %>%
ggplot(aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = 'Species Group: Natv other forbs\nYear: 2012',
x = 'Coverage Class',
y = 'Relative Frequency')
year.ndx <- unique(complete_freq_tbl$SampleYear)
year.ndx
species.ndx <- unique(complete_freq_tbl$SpGroup)
species.ndx
ani.options(interval = 3, loop = T)
species.ndx <- unique(complete_freq_tbl$SpGroup)
for(j in 1:length(species.ndx)){
species <- species.ndx[j]
tmp.df <- filter(complete_freq_tbl, SpGroup == species) %>% ungroup()
gif_title <- paste(species, '.gif', sep = "")
saveGIF({
for(i in 1:length(unique(tmp.df$SampleYear))){
tmp.df2 <- filter(tmp.df, SampleYear == unique(tmp.df$SampleYear)[i])
subtit <- paste('Species Group:',  unique(tmp.df$SpGroup), '\nYear:', unique(tmp.df$SampleYear)[i])
print(
ggplot(tmp.df2, aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = 'Species Group: Natv other forbs\nYear: 2012',
x = 'Coverage Class',
y = 'Relative Frequency')
)
}
}, convert = "convert", movie.name = gif_title)
}
ani.options(interval = 3, loop = T)
species.ndx <- unique(complete_freq_tbl$SpGroup)
for(j in 1:length(species.ndx)){
species <- species.ndx[j]
tmp.df <- filter(complete_freq_tbl, SpGroup == species) %>% ungroup()
gif_title <- paste(species, '.gif', sep = "")
saveGIF({
for(i in 1:length(unique(tmp.df$SampleYear))){
tmp.df2 <- filter(tmp.df, SampleYear == unique(tmp.df$SampleYear)[i])
subtit <- paste('Species Group:',  unique(tmp.df$SpGroup), '\nYear:', unique(tmp.df$SampleYear)[i])
print(
ggplot(tmp.df2, aes(x = cov_class, y = rel_freq)) +
geom_bar(stat = 'identity') +
facet_wrap( ~ Sample_Frame) +
ylim(0, 1) +
labs(title = 'Relative frequencies of coverage class by sampling frame',
subtitle = subtit,
x = 'Coverage Class',
y = 'Relative Frequency')
)
}
}, convert = "convert", movie.name = gif_title)
}
runApp()
exp_samp_max_cdf <- function(theta, alpha, theta_not, n){
#function to calculate cdf of sample max from exponential(theta) distribution
(1 - exp(log(1 - (1 - alpha)^(1/n)) / (theta_not * theta) ))^n
}
exp_samp_max_pwrfunc <- function(theta, alpha, theta_not, n){
#function to calculate cdf of sample max from exponential(theta) distribution
(1 - exp(log(1 - (1 - alpha)^(1/n)) / (theta_not * theta) ))^n
}
runApp()
exp_samp_max_pwrfunc <- function(theta, alpha, theta_not, n){
#function to calculate power function of sample max from exponential(theta) distribution
1 - (1 - exp(log(1 - (alpha)^(1/n)) / (theta_not * theta) ))^n
}
runApp()
runApp()
